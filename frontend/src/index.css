@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── Global ─────────────────────────────────────────────────────────────── */
html, body, #root {
  @apply h-full antialiased;
  color-scheme: dark;
  font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
}

/* ── Scrollbar ──────────────────────────────────────────────────────────── */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 4px;
  transition: background 0.2s;
}
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.16); }

/* ── Code blocks (highlight.js) ─────────────────────────────────────────── */
pre {
  @apply rounded-lg overflow-x-auto text-sm;
  background: #0d0d0d !important;
}
pre code { @apply block p-4; }
code:not(pre code) {
  @apply bg-sidebar-bg text-accent px-1.5 py-0.5 rounded text-sm;
}

/* ── Markdown prose ─────────────────────────────────────────────────────── */
.prose { @apply text-gray-200 leading-relaxed; }
.prose h1 { @apply text-xl font-semibold mt-4 mb-2 text-white; }
.prose h2 { @apply text-lg font-semibold mt-3 mb-1.5 text-white; }
.prose h3 { @apply text-base font-semibold mt-2 mb-1 text-white; }
.prose p { @apply mb-2; }
.prose ul { @apply list-disc ml-5 mb-2; }
.prose ol { @apply list-decimal ml-5 mb-2; }
.prose li { @apply mb-0.5; }
.prose a { @apply text-accent underline underline-offset-2 decoration-accent/40 hover:decoration-accent transition-colors; }
.prose blockquote {
  @apply border-l-4 border-accent/40 pl-4 italic text-gray-400 my-2;
}
.prose table { @apply w-full border-collapse my-2; }
.prose th { @apply border border-sidebar-border bg-sidebar-bg px-3 py-1.5 text-left font-semibold; }
.prose td { @apply border border-sidebar-border px-3 py-1.5; }
.prose strong { @apply text-white font-semibold; }
.prose hr { @apply border-sidebar-border/50 my-4; }

/* ── Animations ─────────────────────────────────────────────────────────── */

/* Basic fade-in (messages, panels) */
.fade-in {
  animation: fadeIn 0.3s ease-out both;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Slide-in (expanded panels, thread detail) */
.slide-in {
  animation: slideIn 0.25s ease-out both;
}
@keyframes slideIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Slide-up (input area, bottom FAB) */
.slide-up {
  animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) both;
}
@keyframes slideUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Scale-in (modals, dashboard) */
.scale-in {
  animation: scaleIn 0.2s cubic-bezier(0.16, 1, 0.3, 1) both;
}
@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

/* Gentle glow pulse for streaming indicator */
@keyframes glowPulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(16, 163, 127, 0); }
  50% { box-shadow: 0 0 12px 2px rgba(16, 163, 127, 0.25); }
}
.glow-pulse { animation: glowPulse 2s ease-in-out infinite; }

/* Typing dots animation */
@keyframes typingBounce {
  0%, 80%, 100% { transform: translateY(0); }
  40% { transform: translateY(-5px); }
}
.typing-dot {
  animation: typingBounce 1.2s ease-in-out infinite;
}
.typing-dot:nth-child(2) { animation-delay: 0.15s; }
.typing-dot:nth-child(3) { animation-delay: 0.3s; }

/* Streaming cursor blink */
@keyframes cursorBlink {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}
.streaming-cursor {
  animation: cursorBlink 1s step-end infinite;
}

/* Skeleton loader */
.skeleton {
  @apply bg-sidebar-hover rounded;
  animation: shimmer 2s ease-in-out infinite;
  background: linear-gradient(
    110deg,
    rgba(255,255,255,0.04) 0%,
    rgba(255,255,255,0.08) 40%,
    rgba(255,255,255,0.04) 60%
  );
  background-size: 200% 100%;
}
@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Bounce for streaming phase dots */
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

/* Concept bubble float-in */
.concept-bubble {
  animation: bubbleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}
@keyframes bubbleIn {
  from { opacity: 0; transform: scale(0.6); }
  to { opacity: 1; transform: scale(1); }
}

/* ── AI Status Bar chip hover ───────────────────────────────────────────── */
.ai-chip {
  transition: all 0.15s ease;
  position: relative;
  overflow: hidden;
}
.ai-chip::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, transparent, rgba(255,255,255,0.05));
  opacity: 0;
  transition: opacity 0.2s;
}
.ai-chip:hover::before { opacity: 1; }
.ai-chip:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

/* ── Token progress bar (dynamic width via CSS variable) ───────────────── */
.token-progress-bar {
  width: var(--progress, 0%);
  transition: width 0.5s ease-out;
}

/* ── Command palette / modal backdrop ───────────────────────────────────── */
.palette-backdrop {
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  backdrop-filter: blur(12px) saturate(120%);
  animation: fadeIn 0.15s ease;
}

/* ── Debug panel monospace ──────────────────────────────────────────────── */
.debug-mono {
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
  font-size: 10px;
  line-height: 1.5;
}

/* ── Subtle gradient accents ────────────────────────────────────────────── */
.accent-gradient {
  background: linear-gradient(135deg, #10a37f, #0ea5e9);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* ── Hover lift effect (cards, buttons) ─────────────────────────────────── */
.hover-lift {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.hover-lift:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
}

/* ── Glass effect for panels ────────────────────────────────────────────── */
.glass {
  background: rgba(23, 23, 23, 0.8);
  -webkit-backdrop-filter: blur(16px) saturate(150%);
  backdrop-filter: blur(16px) saturate(150%);
  border: 1px solid rgba(255,255,255,0.06);
}

/* ── Stagger animation for lists ────────────────────────────────────────── */
.stagger-item {
  animation: fadeIn 0.3s ease-out both;
}
.stagger-item:nth-child(1) { animation-delay: 0ms; }
.stagger-item:nth-child(2) { animation-delay: 50ms; }
.stagger-item:nth-child(3) { animation-delay: 100ms; }
.stagger-item:nth-child(4) { animation-delay: 150ms; }
.stagger-item:nth-child(5) { animation-delay: 200ms; }
.stagger-item:nth-child(6) { animation-delay: 250ms; }
.stagger-item:nth-child(7) { animation-delay: 300ms; }
.stagger-item:nth-child(8) { animation-delay: 350ms; }

/* ── Focus ring ─────────────────────────────────────────────────────────── */
.focus-ring:focus-visible {
  outline: 2px solid rgba(16, 163, 127, 0.5);
  outline-offset: 2px;
}

/* ── Subtle text selection ──────────────────────────────────────────────── */
::selection {
  background: rgba(16, 163, 127, 0.3);
  color: white;
}
